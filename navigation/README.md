# Модуль навигации

[![Build Status](https://travis-ci.org/joemccann/dillinger.svg?branch=master)](https://travis-ci.org/joemccann/dillinger)

Данный репозиторий содержит в себе исходники ноды для решения задачи навигации и формирования маршрута.

### Описание файлов в пакете navigation
В пакете navigation находятся 2 папки:
```
1. src - содержание кастомные модули по работе с навигацией
2. launch - содержание готовые модули по обработке данных с лидара и постраения маршрута, в частоности:
3. gmapping_low.launch - запуск утилиты построения карты, подробнее про параметры задавамые в файле можно узнать здесь: http://wiki.ros.org/gmapping
4. navigation_amcl.launch - запуск утилиты монте-карло локализации, а также загрузка файла карты. Подробнее про amcl можно узнать здесь: http://wiki.ros.org/amcl Про работу с картами здесь: http://wiki.ros.org/map_server
```
Также в папке launch содержится папка move_base. В данной папке содержатся все настройки планировщика движений. Планировщик делится на: глобальный и локальный. В качестве локального планировщика используется DWA_local_planner: http://wiki.ros.org/dwa_local_planner. В качестве глобального планировщика используется стандартный планировщик пакета move_base. Подробнее о настройках можно узнать здесь: http://wiki.ros.org/move_base. Запуск всех настроек планировщика производится с помощью файла move_base.xml.


### Упраление роботом с клавиатуры
Нода удаленного управления расположена в папке navigation/src, называется teleop.py. С помощью нее можно управлять роботом с клавиатуры, запуск осуществляется командой:
```sh
$ rosrun navigation teleop.py
```
Данная нода отправляет в топик cmd_vel сообщения, содержащие необходимую линейную и угловую скорость робота.
### Построение карты
Для построения карты, необходимо запустить утилиту gmapping. А также Rviz, для слежения за прогрессом построения.

Запуск построения карты:
```sh
$ roslaunch navigation gmapping.launch
```
Запуск Rviz на удаленном компьютере с монитором (для этого необходимо объединить все компьютеры в одну ROS сеть) осуществляется следующим образом:
```sh
$ roslaunch navigation rviz.launch
```
Выглядеть это будет следующим образом:

Для того, чтобы сохранить карту используется следующая команда:
```sh
$ rosrun map_server map_server mymap.yaml
```
Карта сохраняется в виде двух файлов: карты в формате pgm и описания карты в формате yaml. Карта сохранится в домашнюю папку, после чего карту необходимо поместить в пакет navigation/launch.

